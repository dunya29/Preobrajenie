const screenWidth=window.innerWidth,menu=document.querySelector(".menu"),modal=document.querySelectorAll(".modal"),modalShowBtn=document.querySelectorAll(".modal-show-btn"),successModal=document.querySelector(".success-modal"),errorModal=document.querySelector(".error-modal");let animSpd=400;function enableScroll(){document.querySelectorAll(".fixed-block")&&document.querySelectorAll(".fixed-block").forEach((e=>e.style.paddingRight="0px")),document.body.style.paddingRight="0px",document.body.classList.remove("noscroll")}function disableScroll(){let e=window.innerWidth>350?window.innerWidth-document.documentElement.clientWidth+"px":0;document.querySelectorAll(".fixed-block")&&document.querySelectorAll(".fixed-block").forEach((t=>t.style.paddingRight=e)),console.log(e),document.body.style.paddingRight=e,document.body.classList.add("noscroll")}function openModal(e){menu.classList.contains("menu--active")||disableScroll(),e.classList.add("open")}function closeModal(e){e.classList.remove("open"),setTimeout((()=>{menu.classList.contains("menu--active")||enableScroll()}),animSpd)}function formSuccess(e){e.querySelectorAll(".item-form").forEach((e=>{e.classList.remove("error"),e.querySelector(".item-form__error")&&(e.querySelector(".item-form__error").textContent=""),e.querySelector(".input__placeholder")&&e.querySelector(".input__placeholder").classList.remove("focused")})),e.querySelectorAll("input").forEach((e=>{["hidden","checkbox","radio"].includes(e.type)||(e.value="")})),e.querySelector("textarea")&&(e.querySelector("textarea").value="");let t=document.querySelector(".modal.open");t?(t.classList.remove("open"),successModal.classList.add("open")):openModal(successModal)}modal.forEach((e=>{e.addEventListener("click",(t=>{e.querySelector(".modal__content").contains(t.target)&&!e.querySelector(".modal__close").contains(t.target)||closeModal(e)}))})),modalShowBtn.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();let r=e.getAttribute("data-modal"),n=e.getAttribute("data-modal-title");"feedback-modal"==r&&(document.getElementById(r).querySelector(".modal__top h3").textContent=n||"Заказать звонок"),openModal(document.getElementById(r))}))}));const menuBurgerOpen=document.querySelector(".header-burger");if(menuBurgerOpen){const e=document.querySelector(".menu"),t=document.querySelector(".menu__close");menuBurgerOpen.addEventListener("click",(()=>{disableScroll(),e.classList.add("menu--active")})),t.addEventListener("click",(()=>{e.classList.remove("menu--active"),setTimeout((()=>{enableScroll()}),500)}))}const inp=document.querySelectorAll("input[type=tel]");if(inp){let r={mask:"+7(999)999-99-99",showMaskOnHover:!1,showMaskOnFocus:!1};inp.forEach((e=>{Inputmask(r).mask(e)}))}const inputs=document.querySelectorAll(".input");0!=inputs.length&&inputs.forEach((e=>{const t=e.firstElementChild,r=e.lastElementChild;r.onfocus=function(){t.classList.add("focused")},r.onblur=function(){""==r.value&&t.classList.remove("focused")}}));const select=document.querySelector(".default"),defaultSelect=()=>{new Choices(select,{searchEnabled:!1,shouldSort:!1})};select&&new Choices(select,{searchEnabled:!1,shouldSort:!1});const tabsPanel=document.querySelectorAll(".motion .tabs__panel");function init1(){let e=[56.351679,43.873314],t=new ymaps.Map("map",{center:e,zoom:16,controls:[]}),r=new ymaps.Map("map-popup",{center:e,zoom:16,controls:[]});var n=new ymaps.control.SearchControl({options:{provider:"yandex#search",noPopup:!0,noSuggestPanel:!0,boundedBy:[[56.351579,43.873214],[56.351779,43.873414]]}}),a=new ymaps.control.SearchControl({options:{provider:"yandex#search",noPopup:!0,noSuggestPanel:!0,boundedBy:[[56.351579,43.873214],[56.351779,43.873414]]}});r.controls.add(a),t.controls.add(n),n.search("Магазины"),a.search("Магазины");const s=document.querySelector(".map__nav").querySelectorAll(".tabs__nav-btn"),o=document.querySelector(".map__nav-popup").querySelectorAll(".tabs__nav-btn");s.forEach(((e,t)=>{e.addEventListener("click",(()=>{s.forEach((e=>{e.classList.remove("active")})),o.forEach((e=>{e.classList.remove("active")})),n.search(e.getAttribute("data-map")),a.search(e.getAttribute("data-map")),s[t].classList.add("active"),o[t].classList.add("active")}))})),o.forEach(((e,t)=>{e.addEventListener("click",(()=>{o.forEach((e=>{e.classList.remove("active")})),s.forEach((e=>{e.classList.remove("active")})),n.search(e.getAttribute("data-map")),a.search(e.getAttribute("data-map")),s[t].classList.add("active"),o[t].classList.add("active")}))})),r.controls.remove("searchControl"),r.controls.remove("trafficControl"),r.controls.remove("typeSelector"),t.controls.remove("searchControl"),t.controls.remove("trafficControl"),t.controls.remove("typeSelector"),r.geoObjects.add(new ymaps.Placemark([56.351679,43.870314],{iconCaption:"ЖК Преображение"},{preset:"islands#redHomeIcon",iconColor:"green"})),t.geoObjects.add(new ymaps.Placemark([56.351679,43.870314],{iconCaption:"ЖК Преображение"},{preset:"islands#redHomeIcon",iconColor:"green"}));const i=document.querySelector(".map__open-extend"),c=document.querySelector(".map__open-reduce"),l=document.querySelector(".popup-map");i.addEventListener("click",(()=>{l.classList.add("active"),disableScroll()})),c.addEventListener("click",(()=>{l.classList.remove("active"),enableScroll()}))}function init2(){let e=new ymaps.Map("map2",{center:[56.346252,43.861564],zoom:13});screenWidth<=768?e.setZoom(11):screenWidth<=1200&&e.setZoom(12),e.controls.remove("searchControl"),e.controls.remove("trafficControl"),e.controls.remove("typeSelector"),e.geoObjects.add(new ymaps.Placemark([56.346252,43.861564],{iconCaption:"Главный офис"},{preset:"islands#greenPocketIcon",iconColor:"green"}))}tabsPanel&&tabsPanel.forEach((e=>{new Swiper(e.querySelector(".swiper"),{slidesPerView:"2",spaceBetween:8,simulateTouch:!0,watchSlidesProgress:!0,observer:!0,observeParents:!0,navigation:{nextEl:e.querySelector(".motion__swiper-button-next"),prevEl:e.querySelector(".motion__swiper-button-prev")},breakpoints:{1199.98:{spaceBetween:32,slidesPerView:"3"},767.98:{slidesPerView:"3",spaceBetween:16}}})})),document.querySelector("#map")&&ymaps.ready(init1),document.querySelector("#map2")&&ymaps.ready(init2);const mapTabs=document.querySelectorAll(".map__point");0!=mapTabs.length&&mapTabs.forEach((e=>{e.addEventListener("click",(()=>{mapTabs.forEach((e=>{e.classList.remove("active")})),e.classList.add("active")}))}));class GraphTabs{constructor(e,t){this.options=Object.assign({isChanged:()=>{}},t),this.selector=e,this.tabs=document.querySelector(`[data-tabs="${e}"]`),this.tabs?(this.tabList=this.tabs.querySelector(".tabs__nav"),this.tabsBtns=this.tabList.querySelectorAll(".tabs__nav-btn"),this.tabsPanels=this.tabs.querySelectorAll(".tabs__panel"),this.check(),this.init(),this.events()):console.error("Селектор data-tabs не существует!")}check(){document.querySelectorAll(`[data-tabs="${this.selector}"]`).length>1?console.error("Количество элементов с одинаковым data-tabs больше одного!"):this.tabsBtns.length===this.tabsPanels.length||console.error("Количество кнопок и элементов табов не совпадает!")}init(){this.tabList.setAttribute("role","tablist"),this.tabsBtns.forEach(((e,t)=>{e.setAttribute("role","tab"),e.setAttribute("tabindex","-1"),e.setAttribute("id",`${this.selector}${t+1}`),e.classList.remove("tabs__nav-btn--active")})),this.tabsPanels.forEach(((e,t)=>{e.setAttribute("role","tabpanel"),e.setAttribute("tabindex","-1"),e.setAttribute("aria-labelledby",this.tabsBtns[t].id),e.classList.remove("tabs__panel--active")})),this.tabsBtns[0].classList.add("tabs__nav-btn--active"),this.tabsBtns[0].removeAttribute("tabindex"),this.tabsBtns[0].setAttribute("aria-selected","true"),this.tabsPanels[0].classList.add("tabs__panel--active")}events(){this.tabsBtns.forEach(((e,t)=>{e.addEventListener("click",(e=>{let t=this.tabList.querySelector("[aria-selected]");e.currentTarget!==t&&this.switchTabs(e.currentTarget,t)})),e.addEventListener("keydown",(e=>{let r=Array.prototype.indexOf.call(this.tabsBtns,e.currentTarget),n=null;n=37===e.which?r-1:39===e.which?r+1:40===e.which?"down":null,null!==n&&("down"===n?this.tabsPanels[t].focus():this.tabsBtns[n]&&this.switchTabs(this.tabsBtns[n],e.currentTarget))}))}))}switchTabs(e,t=this.tabs.querySelector("[aria-selected]")){e.focus(),e.removeAttribute("tabindex"),e.setAttribute("aria-selected","true"),t.removeAttribute("aria-selected"),t.setAttribute("tabindex","-1");let r=Array.prototype.indexOf.call(this.tabsBtns,e),n=Array.prototype.indexOf.call(this.tabsBtns,t);this.tabsPanels[n].classList.remove("tabs__panel--active"),this.tabsPanels[r].classList.add("tabs__panel--active"),this.tabsBtns[n].classList.remove("tabs__nav-btn--active"),this.tabsBtns[r].classList.add("tabs__nav-btn--active"),this.options.isChanged(this)}}const motion=document.querySelector(".motion");if(motion){new GraphTabs("motion")}let newsSwiper,initNews=!1;const news=document.querySelector(".main-news");if(news){function initNewsSwiper(){window.innerWidth<=1199.98&&window.innerWidth>=575.98&&!initNews?(initNews=!0,newsSwiper=new Swiper(news.querySelector(".swiper"),{slidesPerView:2,spaceBetween:16,observe:!0,observeParents:!0,speed:800})):(window.innerWidth>1199.98||window.innerWidth<575.98)&&initNews&&(initNews=!1,newsSwiper.destroy())}initNewsSwiper(),window.addEventListener("resize",initNewsSwiper)}const schemePopup=document.querySelector(".scheme-popup");function setSchemePopup(){document.querySelectorAll(".scheme-cat__apartaments .item-apartaments a").forEach((e=>{function t(){let t=e.getAttribute("data-nmb")?e.getAttribute("data-nmb"):"",r=e.getAttribute("data-name"),n=e.getAttribute("data-area"),a=e.getAttribute("data-floor"),s=e.getAttribute("data-url"),o=e.getAttribute("data-price").replace(/\B(?=(\d{3})+(?!\d))/g," ").trim(),i=e.getAttribute("data-img");schemePopup.querySelector(".scheme-popup__content").innerHTML=`<div class="scheme-popup__header">\n        <h5><span>${r}</span><span>№ ${t}</span></h5>\n        <h6><span>${n} кв. м.</span><span>${a} этаж</span></h6>\n      </div>\n      <a href=${s} class="scheme-popup__preview">\n          <picture><img src=${i} alt=""></picture>\n      </a>\n      <div class="scheme-popup__footer">\n          <div class="h5 scheme-popup__price">${o} руб</div>\n          <a href=${s} class="btn stroke-btn">Подробнее</a>\n      </div>\n        `}e.addEventListener("mouseenter",(()=>{window.innerWidth>991.98&&t()})),e.addEventListener("mousemove",(t=>{window.innerWidth>991.98&&(!function(t,r){schemePopup.classList.add("open");let n=e.getBoundingClientRect().top,a=e.getBoundingClientRect().left;window.innerWidth<a+schemePopup.clientWidth+e.clientWidth+50?schemePopup.style.left=t-schemePopup.clientWidth-10+"px":schemePopup.style.left=t+15+"px",window.innerHeight<n+schemePopup.clientHeight+25?schemePopup.style.top=r-schemePopup.clientHeight-5+"px":schemePopup.style.top=r+25+"px"}(t.clientX,t.clientY),e.addEventListener("mouseleave",(()=>{schemePopup.classList.remove("open"),schemePopup.querySelector(".scheme-popup__content").innerHTML=""})))})),e.addEventListener("click",(e=>{window.innerWidth<=991.98&&(e.preventDefault(),t(),openModal(schemePopup))}))}))}function initSliders(){filter.querySelectorAll(".filter-range").forEach((e=>{let t=e.querySelector(".filter-range__start"),r=e.querySelector(".filter-range__end"),n=e.querySelector(".filter-range__body"),a=+e.getAttribute("data-start"),s=+e.getAttribute("data-end"),o=+e.getAttribute("data-min"),i=+e.getAttribute("data-max");noUiSlider.create(n,{start:[a,s],connect:!0,range:{min:o,max:i}}),t.addEventListener("change",(()=>{n.noUiSlider.set([t.value,null]),setRangeSelected(e,n,o,i)})),r.addEventListener("change",(()=>{n.noUiSlider.set([null,r.value]),setRangeSelected(e,n,o,i)}));let c=[t,r];n.noUiSlider.on("update",(function(t,r){c[r].value=e.classList.contains("filter-range--floor")?parseInt(t[r]):t[r],setRangeSelected(e,n,o,i)})),n.noUiSlider.on("end",(function(e,t){$(document).find("#eFiltr").trigger("submit")}))}))}function setRangeSelected(e,t,r,n){t.noUiSlider.get(!0)[0]!=r||t.noUiSlider.get(!0)[1]!=n?t.classList.add("rangeStartMinDiff"):document.querySelector(".filter-form__room input:checked")||t.classList.remove("rangeStartMinDiff"),e.classList.contains("filter-range--floor")?document.querySelector(".filter-selected__items-floor").innerHTML=`<span>${parseInt(t.noUiSlider.get(0)[0])}-${parseInt(t.noUiSlider.get(0)[1])} этаж</span>`:e.classList.contains("filter-range--square")&&(document.querySelector(".filter-selected__items-square").innerHTML=`<span>${Math.floor(t.noUiSlider.get(0)[0])} м2 - ${Math.ceil(t.noUiSlider.get(0)[1])}м2</span>`),showResetBtn()}function showResetBtn(){document.querySelector(".rangeStartMinDiff")||document.querySelector(".filter-form__room input:checked")?($(".filter-form__reset").slideDown(),$(".filter__mob").slideDown()):($(".filter-form__reset").slideUp(),$(".filter__mob").slideUp())}schemePopup&&setSchemePopup(),document.querySelectorAll(".mob-modal").forEach((e=>{window.addEventListener("resize",(()=>{e.classList.contains("open")&&window.innerWidth>991.98&&closeModal(e)}))}));const filter=document.querySelector(".filter");function tabSwitch(e,t){e.forEach(((r,n)=>{r.addEventListener("click",(()=>{e.forEach((e=>{e.classList.remove("active")})),t.forEach((e=>{e.classList.remove("active")})),r.classList.add("active"),t[n].classList.add("active"),r.style.opacity="0",t[n].style.opacity="0",setTimeout((()=>{r.style.opacity="1",t[n].style.opacity="1"}),0)}))}))}filter&&(initSliders(),document.querySelector(".filter__mob-btn").addEventListener("click",(()=>{window.innerWidth<=991.98&&openModal(document.querySelector(".filter-form"))})),filter.querySelector(".filter-form").addEventListener("reset",(e=>{e.preventDefault(),filter.querySelectorAll(".filter-form__rooms input").forEach((e=>{e.checked=!1,e.removeAttribute("checked")})),filter.querySelectorAll(".filter-range").forEach((e=>{e.querySelector(".filter-range__body").noUiSlider.set([+e.getAttribute("data-min"),+e.getAttribute("data-max")])})),document.querySelector(".filter-selected__items-flats").innerHTML="",$(document).find("#eFiltr").trigger("submit")})),document.querySelector(".filter-form").addEventListener("click",(e=>{document.querySelector(".filter-form .filter-form__btn--submit").contains(e.target)&&closeModal(document.querySelector(".filter-form")),document.querySelector(".filter-form__btn--reset").contains(e.target)&&(e.preventDefault(),filter.querySelector(".filter-form").reset())})),document.querySelector(".filter__header .filter-form__btn").addEventListener("click",(()=>filter.querySelector(".filter-form").reset())),document.querySelectorAll(".filter-form__room").forEach((e=>{e.querySelector("input").addEventListener("change",(()=>{document.querySelector(".filter-selected__items-flats").innerHTML=Array.from(document.querySelectorAll(".filter-form__room input:checked")).map((e=>`<span>${e.getAttribute("data-value")} ккв</span>`)).join(""),showResetBtn()}))})));const flatPage=document.querySelector(".catalog");function initPlanSwipers(){mainPlanSwiper&&(mainPlanSwiper.destroy(),thumbPlanSwiper.destroy()),thumbPlanSwiper=new Swiper(".plan-cat__thumbswiper",{slidesPerView:3.15,spaceBetween:8,observer:!0,observeParents:!0,direction:"horizontal",speed:800,breakpoints:{1399.98:{slidesPerView:5,spaceBetween:20,direction:"vertical"},991.98:{slidesPerView:5,spaceBetween:8,direction:"vertical"},767.98:{slidesPerView:5,spaceBetween:8,direction:"horizontal"},480.98:{slidesPerView:4.1,spaceBetween:8,direction:"horizontal"}}}),mainPlanSwiper=new Swiper(".plan-cat__mainswiper",{slidesPerView:1,observer:!0,observeParents:!0,effect:"fade",fadeEffect:{crossFade:!0},thumbs:{swiper:thumbPlanSwiper},navigation:{nextEl:document.querySelector(".plan-cat .swiper-btn--next"),prevEl:document.querySelector(".plan-cat .swiper-btn--prev")},speed:400}),document.querySelectorAll(".plan-cat__thumbswiper .swiper-slide").length>5&&document.querySelectorAll(".plan-cat .swiper-btn").forEach((e=>e.style.display="flex"))}let thumbPlanSwiper,mainPlanSwiper;if(flatPage&&flatPage.addEventListener("click",(e=>{let t=Array.from(flatPage.querySelectorAll("[data-nav]")).find((t=>t.contains(e.target)));if(t){let e=t.getAttribute("data-nav");flatPage.querySelectorAll("[data-nav]").forEach((e=>{e.classList.remove("active")})),flatPage.querySelectorAll("[data-block]").forEach((e=>{e.classList.remove("active")})),t.classList.add("active"),flatPage.querySelector(`[data-block='${e}']`).classList.add("active"),t.style.opacity="0",flatPage.querySelector(`[data-block='${e}']`).style.opacity="0",setTimeout((()=>{t.style.opacity="1",flatPage.querySelector(`[data-block='${e}']`).style.opacity="1"}),0)}})),document.querySelector(".catalog__plan")&&initPlanSwipers(),document.addEventListener("click",(e=>{document.querySelectorAll("[data-fancy]").forEach((t=>{if(t.contains(e.target)){let e=[],r=[],n=t.getAttribute("data-fit")?t.getAttribute("data-fit"):"",a=t.getAttribute("data-fancy"),s=t.getAttribute("data-txt");document.querySelectorAll("[data-fancy]").forEach((t=>{t.closest(".swiper-slide-duplicate")||t.getAttribute("data-fancy")!==a||(e.push(t.getAttribute("data-src")),r.push(t.getAttribute("data-txt")))}));let o=e.indexOf(t.getAttribute("data-src"));document.querySelector(".footer").insertAdjacentHTML("afterend",`\n        <div class="modal fancy-modal">\n          <div class="modal__overlay">\n            <div class="modal__content">\n                <button class="btn modal__close" aria-label="Закрыть всплывающее окно"></button>\n                  <div class="swiper mainswiper">\n                    <div class="swiper-wrapper">\n                       ${e.map(((e,t)=>`<div class="swiper-slide">\n                             <div class="swiper-img ${n}">\n                                 <img src=${e} alt="">\n                             </div>\n                             ${s&&r[t].length>0?`<p>${r[t]}</p>`:""}\n                         </div>`)).join("")}\n                    </div>\n                  </div>\n            </div>\n          </div>\n        </div>\n       `);new Swiper(".fancy-modal .swiper",{slidesPerView:1,spaceBetween:20,observer:!0,observeParents:!0,initialSlide:o,speed:800});const i=document.querySelector(".fancy-modal");openModal(i),i.addEventListener("click",(e=>{i.querySelector(".modal__content").contains(e.target)&&!i.querySelector(".modal__close").contains(e.target)||(closeModal(i),setTimeout((()=>{i.remove()}),animSpd))}))}}))})),document.querySelector(".product")){let n=new Swiper(".product__thumbswiper",{slidesPerView:3,spaceBetween:8,observer:!0,observeParents:!0,direction:"horizontal",speed:800,breakpoints:{1399.98:{slidesPerView:3,spaceBetween:20,direction:"horizontal"},991.98:{slidesPerView:3.33,spaceBetween:8,direction:"horizontal"},767.98:{slidesPerView:3,spaceBetween:16,direction:"vertical"}}});new Swiper(".product__mainswiper",{slidesPerView:1,observer:!0,observeParents:!0,effect:"fade",fadeEffect:{crossFade:!0},thumbs:{swiper:n},speed:400})}